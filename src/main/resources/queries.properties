findByMEI = SELECT e.*, 'MAIN' as record_type, NULL as parent_customer_id \
            FROM entities e WHERE e.mei = ? \
            UNION ALL \
            SELECT e.*, 'LOCATION' as record_type, l.parent_customer_id \
            FROM entity_locations l \
            JOIN entities e ON l.location_id = e.entity_id \
            WHERE l.mei = ?

findByLEI = SELECT e.*, 'MAIN' as record_type, NULL as parent_customer_id \
            FROM entities e WHERE e.lei = ? \
            UNION ALL \
            SELECT e.*, 'LOCATION' as record_type, l.parent_customer_id \
            FROM entity_locations l \
            JOIN entities e ON l.location_id = e.entity_id \
            WHERE l.lei = ?

findByEIN = SELECT e.*, 'MAIN' as record_type, NULL as parent_customer_id \
            FROM entities e WHERE REPLACE(e.ein, '-', '') = REPLACE(?, '-', '') \
            UNION ALL \
            SELECT e.*, 'LOCATION' as record_type, l.parent_customer_id \
            FROM entity_locations l \
            JOIN entities e ON l.location_id = e.entity_id \
            WHERE REPLACE(l.ein, '-', '') = REPLACE(?, '-', '')

findByDebtDomainId = SELECT *, 'MAIN' as record_type, NULL as parent_customer_id \
                     FROM entities WHERE debt_domain_id = ?

findByName = SELECT *, 'MAIN' as record_type, NULL as parent_customer_id \
             FROM entities WHERE \
             LOWER(full_name) LIKE ? OR \
             LOWER(short_name) LIKE ? OR \
             LOWER(ultimate_parent) LIKE ? \
             ORDER BY CASE \
               WHEN LOWER(full_name) = LOWER(?) THEN 1 \
               WHEN LOWER(short_name) = LOWER(?) THEN 2 \
               ELSE 3 END \
             LIMIT 100

findByEmailDomain = SELECT *, 'MAIN' as record_type, NULL as parent_customer_id \
                    FROM entities WHERE \
                    email_domain = ? OR \
                    LOWER(full_name) LIKE ? OR \
                    LOWER(ultimate_parent) LIKE ?

findByCleanedShortName = SELECT *, 'MAIN' as record_type, NULL as parent_customer_id \
                         FROM entities WHERE \
                         REGEXP_REPLACE(LOWER(short_name), '[^a-z0-9]', '') = ?

findById = SELECT *, 'MAIN' as record_type, NULL as parent_customer_id \
           FROM entities WHERE entity_id = ?
